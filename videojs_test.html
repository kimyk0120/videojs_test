<!DOCTYPE html>
<!--suppress ALL -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>video_js_test</title>
    <link href="node_modules/video.js/dist/video-js.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
</head>
<body>
    <h1>VIDEO.JS TEST</h1>
    <div id="container">
        <video id='my_video' class='video-js vjs-big-play-centered vjs-fluid vjs-time-control'
               controls="controls" preload='none' width="600" poster="http://media.w3.org/2010/05/sintel/poster.png" data-setup='{"playbackRates": [0.5, 1, 1.5, 2] }'>
<!--            <source id='mp4' src="http://media.w3.org/2010/05/sintel/trailer.mp4" type='video/mp4' />-->
<!--            <source id='webm' src="http://media.w3.org/2010/05/sintel/trailer.webm" type='video/webm' />-->
<!--            <source id='ogv' src="http://media.w3.org/2010/05/sintel/trailer.ogv" type='video/ogg' />-->
            <track kind='captions' src='videojs_test.vtt' srclang='en' label='English' default/>
        </video>
    </div>
    <script src="node_modules/video.js/dist/video.min.js"></script>
<script type="text/javascript">


$(document).ready(function(){
    // element
    var myPlayer = videojs('my_video');
    console.log(myPlayer);

    // source
    myPlayer.src({type: 'video/mp4', src: 'http://media.w3.org/2010/05/sintel/trailer.mp4'});
    myPlayer.one("loadedmetadata", onLoadedMetadata);

    function onLoadedMetadata() {
        alert(myPlayer.duration()); // 총 시간은 비디오 시작전에는 NaN으로 리턴이됨
    }

    // current time get/set
    myPlayer.ready(function() {
        myPlayer.currentTime(0);  // set
        var whereYouAt = myPlayer.currentTime();  // get
        console.log(whereYouAt);

    });


    // var threshold = 4;
    // var thresholdReached = false;

    // duration, current time
    myPlayer.on('timeupdate', function () {

        // console.log(myPlayer.readyState());

        var lengthOfVideo = myPlayer.duration();
        // console.log(lengthOfVideo);

        var whereYouAt = myPlayer.currentTime();
        // console.log(whereYouAt);

        // if (myPlayer.currentTime() >= threshold && !thresholdReached) {
        //     thresholdReached = true;
        //     alert('Started');
        // }
    });

    // is Paused
    myPlayer.on("click", function(event){
        event.preventDefault();
        var isPaused = myPlayer.paused();
        console.log(isPaused);
    });

    // var srtText = `1
    //               00:00:00,500 --> 00:00:02,000
    //               One caption
    //               2
    //               00:00:03,000 --> 00:00:05,000
    //               Another caption`;
    // var srtRegex = /(.*\n)?(\d\d:\d\d:\d\d),(\d\d\d --> \d\d:\d\d:\d\d),(\d\d\d)/g;
    // var vttText = 'WEBVTT\n\n' + srtText.replace(srtRegex, '$1$2.$3.$4');
    //
    // console.log(vttText);
    //
    // var vttBlob = new Blob([vttText], {type : 'text/vtt'});
    // var blobURL = URL.createObjectURL(vttBlob);
    // myPlayer.on('loadedmetadata', function() {
    //     console.log("$$");
    //     this.addRemoteTextTrack({
    //         src: blobURL,
    //         srclang: 'en',
    //         label: 'english',
    //         kind: 'subtitles',
    //     }, true);
    // });

    // var tracks = myPlayer.textTracks();
    // console.log(tracks);
    //
    // for (var i = 0; i < tracks.length; i++) {
    //     var track = tracks[i];
    //
    //     // Find the English captions track and mark it as "showing".
    //     if (track.kind === 'captions' && track.language === 'en') {
    //         track.mode = 'showing';
    //     }
    // }

    // 재생 속도 조절
    //attr = data-setup='{"playbackRates": [0.5, 1, 1.5, 2] }'


}); // end DOMReady


    
</script>
</body>
</html>